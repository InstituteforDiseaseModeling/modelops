# Repository Guidelines

## Project Structure & Module Organization
The CLI, SDK, and orchestration logic live under `src/modelops`, which is split into `cli/`, `components/`, `infra/`, `services/`, and typed helpers in `utils/` and `core/`. Tests mirror that layout in `tests/`, with integration-specific fixtures in `tests/integration/` and telemetry cases in `tests/telemetry/`. Container definitions stay in `docker/`, scripts for CI/debugging in `scripts/` and `clean-test.sh`, long-form design docs in `docs/`, and runnable workflows in `examples/`. Assets generated by experiments belong in `results/` to keep source trees clean.

## Build, Test, and Development Commands
- `uv sync` or `make install` installs all extras defined in `pyproject.toml`.
- `make test` (unit) and `make test-integration` (needs a Dask cluster or `make dask-local`) run the pytest suites wired through UV.
- `make lint` executes `ruff check src/ tests/` and `mypy` (non-fatal) so run it before pushing.
- `make dask-local`/`make dask-stop` starts a local scheduler for debugging.
- Deployers use `mops infra up`, `mops infra status`, and `make rollout-images` once GitHub Actions produces new container tags.

## Coding Style & Naming Conventions
Ruff enforces 100-character lines, double quotes, import sorting, and `py312` features; formatters are run via `uv run ruff format src/ tests/`. Use four-space indents and type hints (the package ships `py.typed`). Modules should use `snake_case.py`, classes `PascalCase`, and exported Typer commands stay under `src/modelops/cli/`. Keep config constants in `versions.py` or `core/`, and prefer dependency injection through the `components/` registries.

## Testing Guidelines
Pytest is configured in `pyproject.toml` to skip integration tests by default. Name files `test_*.py`, scope fixtures in `tests/fixtures/`, and tag long-running cases with `@pytest.mark.integration` (runs via `make test-integration`). To get coverage locally, run `uv run pytest --cov=src/modelops --cov-report=html`. Integration suites require a running worker pool; use `make dask-local` or point `--dask-address` at an existing cluster.

## Commit & Pull Request Guidelines
Commits follow the explicit style captured in `commit-messages.md`—see `f11f173a111889cbb2d45b846c01ed1cbc0a269b` for the canonical format:

```
<type>: concise subject

Paragraph(s) detailing:
- Root cause / motivation
- Key files or subsystems touched
- Expected behaviour change or perf impact
```

Even small fixes need a narrative body (no “misc cleanup” or single-sentence commits). Mention modules, relevant scripts, and any follow-up expectations so future readers can understand intent without diff-diving. Reference GitHub issues or incident IDs inline when applicable.

Open PRs from feature branches, link tracking issues, describe configuration or schema updates, and attach screenshots/log excerpts for UX or telemetry changes. CI must pass lint, unit, integration, and docker build workflows before requesting review; rerun `uv run pre-commit run --all-files` locally if automation fails.
